%
\chapter{Runtime architecture}
%

As the needed source files are generated, we now can use them to execute the given graph queries on a distributed system. In the previous chapters, we could see how the framework generates the source codes, in this framework I show, how those source codes are integrated with the existing \cpp{} library.



\section{Live model manipulation}
Model code is generated to help the creation and maintenance of the live model.
To create the model, first the \texttt{ModelRoot} class must be instanced.
On different computation units, the models are synchronized by the software using DDS.
Topics are created for two types of model update:
\begin{itemize}
	\item Object creation/deletion -- We need the information because if a graph pattern refers to remote objects, we create proxy elements for them.  
	\item Reference creation/deletion (change) -- This is needed, because references can have opposites: For one reference change on another computing unit, we may need to alter (create/delete) its opposite reference on an object, that may be on this computation unit.
\end{itemize}

\begin{figure}[H]
	\begin{center}
		\includegraphics[width=0.8\textwidth]{figures/model-dds.pdf}
		\caption{ Synchronization of models via DDS }
		\label{fig:model-dds}
	\end{center}
\end{figure}

\section{Query execution}

The execution of the queries are happening at different computation units, which are connected via network.
On each computation unit, an instance of the software is running.
The basic architecture of the monitoring components of a running instance can be seen on \autoref{fig:query-runner-architecture}. 
The component called \texttt{QueryService} handles the communication between instances of the software.
\texttt{QueryRunner}s are responsible for running the local operations of a certain query execution. Executing a query requires \texttt{QueryRunner}s on each computation unit assigned to each other and communicating via \texttt{QueryService}. 
Each \texttt{QueryRunner} processes the model while execute their search operations.

\begin{figure}[H]
	\begin{center}
		\includegraphics[width=0.8\textwidth]{figures/query-runner-architecture.pdf}
		\caption{ Basic architecture of the query running system }
		\label{fig:query-runner-architecture}
	\end{center}
\end{figure}

\subsection{Integration of generated code}

As the query running components are generated, we need a way to integrate them.









